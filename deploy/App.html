<!DOCTYPE html>
<html>
<head>
    <title>point-burndown</title>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("Rally.example.BurnCalculator",{extend:"Rally.data.lookback.calculator.TimeSeriesCalculator",constructor:function(config){this.initConfig(config),this.callParent(arguments)},getDerivedFieldsOnInput:function(){var completedScheduleStateNames=["Released"],uncommitedScheduleStateNames=["Idea"];return[{as:"Remaining",f:function(snapshot){return!_.contains(completedScheduleStateNames,snapshot.ScheduleState)&&snapshot.PlanEstimate?snapshot.PlanEstimate:0}},{as:"Total Scope",f:function(snapshot){return!_.contains(uncommitedScheduleStateNames,snapshot.ScheduleState)&&snapshot.PlanEstimate?snapshot.PlanEstimate:0}},{as:"Guideline",f:function(snapshot){var new_date=new Date(snapshot.tick[0]),old_date=new Date("2016-03-28");if(isNaN(new_date)||isNaN(old_date))return 0;for(var workdays=0,date=old_date;new_date>date;)0!==date.getDay()&&6!=date.getDay()&&(workdays+=1),date.setDate(date.getDate()+1);return workdays}}]},getMetrics:function(){return[{field:"Remaining",as:"Remaining",display:"column",f:"sum"},{field:"Total Scope",as:"Total Scope",display:"line",f:"sum"},{field:"Guideline",as:"Guideline",display:"line",f:"max"}]}});var ITERATION_OID=47998626614;Ext.define("CustomApp",{extend:"Rally.app.App",requires:["Rally.example.BurnCalculator"],launch:function(){this.add({xtype:"rallychart",storeType:"Rally.data.lookback.SnapshotStore",storeConfig:this._getStoreConfig(),calculatorType:"Rally.example.BurnCalculator",calculatorConfig:{completedScheduleStateNames:["Released"],startDate:new Date("2016-03-28"),endDate:new Date("2016-04-08")},chartConfig:this._getChartConfig()})},_getStoreConfig:function(){return{find:{Iteration:ITERATION_OID},fetch:["ScheduleState","PlanEstimate"],hydrate:["ScheduleState"],sort:{_ValidFrom:1},context:this.getContext().getDataContext(),limit:1/0}},_getChartConfig:function(){return{chart:{defaultSeriesType:"area",zoomType:"xy"},title:{text:"Iteration Burndown"},xAxis:{categories:[],tickmarkPlacement:"on",tickInterval:1,title:{text:"Date",margin:10}},yAxis:[{title:{text:"Points"}}],tooltip:{formatter:function(){return""+this.x+"<br />"+this.series.name+": "+this.y}},plotOptions:{series:{marker:{enabled:!1,states:{hover:{enabled:!0}}},groupPadding:.01},column:{stacking:null,shadow:!1}}}}});

            Rally.launchApp('CustomApp', {
                name:"point-burndown",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
